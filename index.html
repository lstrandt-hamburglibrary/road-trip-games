<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Road Trip Games - Your Ultimate Travel Companion</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff6b35">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Road Trip">

    <!-- App Version for automatic updates -->
    <script>window.APP_VERSION = '1.7.0';</script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .content {
            padding: 2rem;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .feature-card p {
            opacity: 0.9;
        }

        .welcome {
            text-align: center;
            padding: 2rem;
        }

        .welcome h2 {
            color: #333;
            margin-bottom: 1rem;
        }

        .welcome p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4caf50;
            color: white;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .toast.show {
            opacity: 1;
            pointer-events: auto;
        }

        .roadmap {
            margin-top: 3rem;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .roadmap h2 {
            color: #333;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .roadmap-section {
            margin-bottom: 2rem;
        }

        .roadmap-section h3 {
            color: #ff6b35;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .roadmap-list {
            list-style: none;
            padding: 0;
        }

        .roadmap-list li {
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .roadmap-list li.completed {
            border-left-color: #28a745;
            opacity: 0.7;
        }

        .roadmap-list li.in-progress {
            border-left-color: #f7931e;
            font-weight: bold;
        }

        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            margin-left: auto;
            font-weight: bold;
        }

        .status-badge.completed {
            background: #28a745;
            color: white;
        }

        .status-badge.in-progress {
            background: #f7931e;
            color: white;
        }

        .status-badge.planned {
            background: #6c757d;
            color: white;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="updateToast" class="toast"></div>
    <div class="app-container">
        <div class="header">
            <h1>🚗 Road Trip Games</h1>
            <p>Your Ultimate Travel Companion</p>
        </div>

        <div class="content">
            <div class="welcome">
                <h2>Welcome to Road Trip Games!</h2>
                <p>The all-in-one app for making your road trips more fun and memorable. Track license plates, play games, and learn interesting facts along the way!</p>
            </div>

            <div class="feature-grid">
                <div class="feature-card" onclick="showLicensePlateTracker()">
                    <h3>🚙 License Plates</h3>
                    <p>Track all the state plates you spot on your journey</p>
                </div>

                <div class="feature-card" onclick="showGamesMenu()">
                    <h3>🎮 Games</h3>
                    <p>Play fun games to pass the time on long drives</p>
                </div>

                <div class="feature-card" onclick="alert('GPS Facts - Coming Soon!')">
                    <h3>📍 GPS Facts</h3>
                    <p>Learn interesting facts about places you're driving through</p>
                </div>

                <div class="feature-card" onclick="alert('Trip Bingo - Coming Soon!')">
                    <h3>🎯 Travel Bingo</h3>
                    <p>Spot common road trip sights and win!</p>
                </div>
            </div>

            <!-- License Plate Tracker Section (hidden by default) -->
            <div id="plateTracker" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2>🚙 License Plate Tracker</h2>
                    <button onclick="showHome()" style="background: #6c757d; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1rem;">← Back to Home</button>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem; border-radius: 15px; margin-bottom: 2rem;">
                    <div style="text-align: center; margin-bottom: 1.5rem;">
                        <h3 style="font-size: 2rem; margin-bottom: 0.5rem;" id="plateProgress">0 / 64</h3>
                        <p style="font-size: 1.1rem;">Total Plates Collected</p>
                        <div style="background: white; height: 20px; border-radius: 10px; overflow: hidden; margin-top: 1rem;">
                            <div id="plateProgressBar" style="background: #28a745; height: 100%; width: 0%; transition: width 0.3s;"></div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem; padding-top: 1.5rem; border-top: 2px solid rgba(255,255,255,0.3);">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold;" id="usProgress">0 / 51</div>
                            <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 0.25rem;">🇺🇸 United States</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold;" id="canadaProgress">0 / 13</div>
                            <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 0.25rem;">🇨🇦 Canada</div>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                    <!-- US States Section -->
                    <div>
                        <h3 style="color: #ff6b35; margin-bottom: 1rem; font-size: 1.5rem;">🇺🇸 United States</h3>
                        <div id="usStates"></div>
                    </div>

                    <!-- Canadian Provinces Section -->
                    <div>
                        <h3 style="color: #ff6b35; margin-bottom: 1rem; font-size: 1.5rem;">🇨🇦 Canada</h3>
                        <div id="canadaProvinces"></div>
                    </div>
                </div>
            </div>

            <!-- Games Menu Section (hidden by default) -->
            <div id="gamesMenu" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2>🎮 Road Trip Games</h2>
                    <button onclick="showHome()" style="background: #6c757d; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1rem;">← Back to Home</button>
                </div>

                <div class="feature-grid">
                    <div class="feature-card" onclick="launchBattleship()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h3>⚓ Battleship</h3>
                        <p>Pass-and-play naval combat game</p>
                    </div>

                    <div class="feature-card" onclick="launchConnectFour()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <h3>🔴 Connect 4</h3>
                        <p>Drop discs and connect four in a row</p>
                    </div>

                    <div class="feature-card" onclick="launchWar()" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <h3>🃏 War</h3>
                        <p>Classic card battle game</p>
                    </div>

                    <div class="feature-card" onclick="launchGuessWho()" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <h3>🕵️ Guess Who</h3>
                        <p>Figure out the mystery person</p>
                    </div>

                    <div class="feature-card" onclick="launchDotsAndBoxes()" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <h3>📦 Dots and Boxes</h3>
                        <p>Connect dots to capture boxes</p>
                    </div>

                    <div class="feature-card" onclick="launchTicTacToe()" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                        <h3>⭕ Tic Tac Toe</h3>
                        <p>Classic X's and O's strategy</p>
                    </div>

                    <div class="feature-card" onclick="launchTrash()" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                        <h3>🗑️ Trash</h3>
                        <p>Fast-paced card game</p>
                    </div>

                    <div class="feature-card" onclick="launchISpy()" style="background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);">
                        <h3>👀 I Spy</h3>
                        <p>Classic observation game</p>
                    </div>

                    <div class="feature-card" onclick="launchTwentyQuestions()" style="background: linear-gradient(135deg, #fdcbf1 0%, #e6dee9 100%);">
                        <h3>❓ 20 Questions</h3>
                        <p>Guess what I'm thinking!</p>
                    </div>

                    <div class="feature-card" onclick="launchWouldYouRather()" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                        <h3>🤔 Would You Rather</h3>
                        <p>Funny and tough choices</p>
                    </div>

                    <div class="feature-card" onclick="launchOthello()" style="background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);">
                        <h3>⚫ Othello</h3>
                        <p>Flip discs to dominate the board</p>
                    </div>

                    <div class="feature-card" onclick="launchTrouble()" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);">
                        <h3>🎲 Trouble</h3>
                        <p>Pop and move around the board</p>
                    </div>

                    <div class="feature-card" onclick="launchMinesweeper()" style="background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);">
                        <h3>💣 Minesweeper</h3>
                        <p>Clear the grid without hitting mines</p>
                    </div>
                </div>
            </div>

            <!-- Battleship Game Section (hidden by default) -->
            <div id="battleshipGame" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2>⚓ Battleship</h2>
                    <button onclick="exitBattleship()" style="background: #6c757d; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1rem;">← Back to Games</button>
                </div>
                <div id="battleshipContent"></div>
            </div>

            <div id="connect4Game" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <h2>🔴 Connect 4</h2>
                    <button onclick="exitConnect4()" style="background: #6c757d; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1rem;">← Back to Games</button>
                </div>
                <div id="connect4Content"></div>
            </div>

            <div class="roadmap">
                <h2>🗺️ Development Roadmap</h2>

                <div class="roadmap-section">
                    <h3>✅ Completed</h3>
                    <ul class="roadmap-list">
                        <li class="completed">
                            <span>🚀 Initial PWA setup with offline support</span>
                            <span class="status-badge completed">Done</span>
                        </li>
                        <li class="completed">
                            <span>📱 Mobile-responsive design</span>
                            <span class="status-badge completed">Done</span>
                        </li>
                        <li class="completed">
                            <span>🚙 License Plate Tracker - All 51 US states/DC + 13 Canadian provinces</span>
                            <span class="status-badge completed">Done</span>
                        </li>
                    </ul>
                </div>

                <div class="roadmap-section">
                    <h3>🎯 Up Next</h3>
                    <ul class="roadmap-list">
                        <li class="planned">
                            <span>🎮 Classic Road Trip Games (I Spy, 20 Questions, Would You Rather)</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                    </ul>
                </div>

                <div class="roadmap-section">
                    <h3>💡 Future Features</h3>
                    <ul class="roadmap-list">
                        <li class="planned">
                            <span>🎯 Travel Bingo (Spot cows, water towers, bridges, etc.)</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                        <li class="planned">
                            <span>📍 GPS-Based Location Facts</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                        <li class="planned">
                            <span>📊 Trip Statistics & Mileage Tracker</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                        <li class="planned">
                            <span>📸 Trip Photo Journal</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                        <li class="planned">
                            <span>🗺️ Interactive Trip Map</span>
                            <span class="status-badge planned">Planned</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // License plate data with abbreviations
        const US_STATES = [
            { name: 'Alabama', abbr: 'AL' },
            { name: 'Alaska', abbr: 'AK' },
            { name: 'Arizona', abbr: 'AZ' },
            { name: 'Arkansas', abbr: 'AR' },
            { name: 'California', abbr: 'CA' },
            { name: 'Colorado', abbr: 'CO' },
            { name: 'Connecticut', abbr: 'CT' },
            { name: 'Delaware', abbr: 'DE' },
            { name: 'District of Columbia', abbr: 'DC' },
            { name: 'Florida', abbr: 'FL' },
            { name: 'Georgia', abbr: 'GA' },
            { name: 'Hawaii', abbr: 'HI' },
            { name: 'Idaho', abbr: 'ID' },
            { name: 'Illinois', abbr: 'IL' },
            { name: 'Indiana', abbr: 'IN' },
            { name: 'Iowa', abbr: 'IA' },
            { name: 'Kansas', abbr: 'KS' },
            { name: 'Kentucky', abbr: 'KY' },
            { name: 'Louisiana', abbr: 'LA' },
            { name: 'Maine', abbr: 'ME' },
            { name: 'Maryland', abbr: 'MD' },
            { name: 'Massachusetts', abbr: 'MA' },
            { name: 'Michigan', abbr: 'MI' },
            { name: 'Minnesota', abbr: 'MN' },
            { name: 'Mississippi', abbr: 'MS' },
            { name: 'Missouri', abbr: 'MO' },
            { name: 'Montana', abbr: 'MT' },
            { name: 'Nebraska', abbr: 'NE' },
            { name: 'Nevada', abbr: 'NV' },
            { name: 'New Hampshire', abbr: 'NH' },
            { name: 'New Jersey', abbr: 'NJ' },
            { name: 'New Mexico', abbr: 'NM' },
            { name: 'New York', abbr: 'NY' },
            { name: 'North Carolina', abbr: 'NC' },
            { name: 'North Dakota', abbr: 'ND' },
            { name: 'Ohio', abbr: 'OH' },
            { name: 'Oklahoma', abbr: 'OK' },
            { name: 'Oregon', abbr: 'OR' },
            { name: 'Pennsylvania', abbr: 'PA' },
            { name: 'Rhode Island', abbr: 'RI' },
            { name: 'South Carolina', abbr: 'SC' },
            { name: 'South Dakota', abbr: 'SD' },
            { name: 'Tennessee', abbr: 'TN' },
            { name: 'Texas', abbr: 'TX' },
            { name: 'Utah', abbr: 'UT' },
            { name: 'Vermont', abbr: 'VT' },
            { name: 'Virginia', abbr: 'VA' },
            { name: 'Washington', abbr: 'WA' },
            { name: 'West Virginia', abbr: 'WV' },
            { name: 'Wisconsin', abbr: 'WI' },
            { name: 'Wyoming', abbr: 'WY' }
        ];

        const CANADA_PROVINCES = [
            { name: 'Alberta', abbr: 'AB' },
            { name: 'British Columbia', abbr: 'BC' },
            { name: 'Manitoba', abbr: 'MB' },
            { name: 'New Brunswick', abbr: 'NB' },
            { name: 'Newfoundland and Labrador', abbr: 'NL' },
            { name: 'Northwest Territories', abbr: 'NT' },
            { name: 'Nova Scotia', abbr: 'NS' },
            { name: 'Nunavut', abbr: 'NU' },
            { name: 'Ontario', abbr: 'ON' },
            { name: 'Prince Edward Island', abbr: 'PE' },
            { name: 'Quebec', abbr: 'QC' },
            { name: 'Saskatchewan', abbr: 'SK' },
            { name: 'Yukon', abbr: 'YT' }
        ];

        // Generate license plate SVG
        function createPlateSVG(abbr, isChecked) {
            return `
                <svg width="100" height="50" viewBox="0 0 100 50" style="border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                    <rect width="100" height="50" rx="4" fill="${isChecked ? '#28a745' : '#4a90e2'}"/>
                    <rect x="2" y="2" width="96" height="46" rx="3" fill="white"/>
                    <text x="50" y="32" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="${isChecked ? '#28a745' : '#333'}">${abbr}</text>
                </svg>
            `;
        }

        // Load saved progress from localStorage
        let collectedPlates = JSON.parse(localStorage.getItem('collectedPlates') || '{}');

        function showHome() {
            document.querySelector('.welcome').style.display = 'block';
            document.querySelector('.feature-grid').style.display = 'grid';
            document.querySelector('.roadmap').style.display = 'block';
            document.getElementById('plateTracker').style.display = 'none';
            document.getElementById('gamesMenu').style.display = 'none';
        }

        function showGamesMenu() {
            document.querySelector('.welcome').style.display = 'none';
            document.querySelector('.feature-grid').style.display = 'none';
            document.querySelector('.roadmap').style.display = 'none';
            document.getElementById('plateTracker').style.display = 'none';
            document.getElementById('gamesMenu').style.display = 'block';
        }

        function showLicensePlateTracker() {
            document.querySelector('.welcome').style.display = 'none';
            document.querySelector('.feature-grid').style.display = 'none';
            document.querySelector('.roadmap').style.display = 'none';
            document.getElementById('plateTracker').style.display = 'block';
            loadPlateTracker();
        }

        function loadPlateTracker() {
            // Render US States
            const usContainer = document.getElementById('usStates');
            usContainer.innerHTML = US_STATES.map(state => {
                const isChecked = collectedPlates[state.name] || false;
                return `
                    <label style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: ${isChecked ? '#d4edda' : 'white'}; margin-bottom: 0.75rem; border-radius: 10px; cursor: pointer; border: 2px solid ${isChecked ? '#28a745' : '#e9ecef'}; transition: all 0.2s;">
                        <input type="checkbox" ${isChecked ? 'checked' : ''} onchange="togglePlate('${state.name}')" style="width: 24px; height: 24px; cursor: pointer;">
                        <div style="flex-shrink: 0;">
                            ${createPlateSVG(state.abbr, isChecked)}
                        </div>
                        <span style="font-size: 1.1rem; font-weight: ${isChecked ? 'bold' : 'normal'}; color: ${isChecked ? '#155724' : '#333'};">${state.name}</span>
                        ${isChecked ? '<span style="margin-left: auto; color: #28a745; font-size: 1.5rem;">✓</span>' : ''}
                    </label>
                `;
            }).join('');

            // Render Canadian Provinces
            const canadaContainer = document.getElementById('canadaProvinces');
            canadaContainer.innerHTML = CANADA_PROVINCES.map(province => {
                const isChecked = collectedPlates[province.name] || false;
                return `
                    <label style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: ${isChecked ? '#d4edda' : 'white'}; margin-bottom: 0.75rem; border-radius: 10px; cursor: pointer; border: 2px solid ${isChecked ? '#28a745' : '#e9ecef'}; transition: all 0.2s;">
                        <input type="checkbox" ${isChecked ? 'checked' : ''} onchange="togglePlate('${province.name}')" style="width: 24px; height: 24px; cursor: pointer;">
                        <div style="flex-shrink: 0;">
                            ${createPlateSVG(province.abbr, isChecked)}
                        </div>
                        <span style="font-size: 1.1rem; font-weight: ${isChecked ? 'bold' : 'normal'}; color: ${isChecked ? '#155724' : '#333'};">${province.name}</span>
                        ${isChecked ? '<span style="margin-left: auto; color: #28a745; font-size: 1.5rem;">✓</span>' : ''}
                    </label>
                `;
            }).join('');

            updateProgress();
        }

        function togglePlate(name) {
            collectedPlates[name] = !collectedPlates[name];
            if (!collectedPlates[name]) {
                delete collectedPlates[name];
            }
            localStorage.setItem('collectedPlates', JSON.stringify(collectedPlates));
            loadPlateTracker();
        }

        function updateProgress() {
            // Calculate US states collected
            const usCollected = US_STATES.filter(s => collectedPlates[s.name]).length;
            const usTotal = US_STATES.length;

            // Calculate Canada provinces collected
            const canadaCollected = CANADA_PROVINCES.filter(p => collectedPlates[p.name]).length;
            const canadaTotal = CANADA_PROVINCES.length;

            // Calculate total
            const total = usTotal + canadaTotal;
            const collected = usCollected + canadaCollected;
            const percentage = (collected / total * 100).toFixed(1);

            // Update displays
            document.getElementById('plateProgress').textContent = `${collected} / ${total}`;
            document.getElementById('plateProgressBar').style.width = `${percentage}%`;
            document.getElementById('usProgress').textContent = `${usCollected} / ${usTotal}`;
            document.getElementById('canadaProgress').textContent = `${canadaCollected} / ${canadaTotal}`;
        }

        // Battleship Game State
        let battleshipState = {
            phase: 'setup', // setup, player1_place, player2_place, battle
            currentPlayer: 1,
            player1: {
                grid: Array(10).fill(null).map(() => Array(10).fill(null)),
                ships: [],
                hits: [],
                misses: []
            },
            player2: {
                grid: Array(10).fill(null).map(() => Array(10).fill(null)),
                ships: [],
                hits: [],
                misses: []
            },
            ships: [
                { name: 'Carrier', size: 5, placed: false },
                { name: 'Battleship', size: 4, placed: false },
                { name: 'Cruiser', size: 3, placed: false },
                { name: 'Submarine', size: 3, placed: false },
                { name: 'Destroyer', size: 2, placed: false }
            ],
            currentShipIndex: 0,
            orientation: 'horizontal'
        };

        // Game launcher functions
        function launchBattleship() {
            // Reset game state
            battleshipState = {
                phase: 'setup',
                currentPlayer: 1,
                player1Name: '',
                player2Name: '',
                player1: {
                    grid: Array(10).fill(null).map(() => Array(10).fill(null)),
                    ships: [],
                    hits: [],
                    misses: []
                },
                player2: {
                    grid: Array(10).fill(null).map(() => Array(10).fill(null)),
                    ships: [],
                    hits: [],
                    misses: []
                },
                ships: [
                    { name: 'Carrier', size: 5, placed: false },
                    { name: 'Battleship', size: 4, placed: false },
                    { name: 'Cruiser', size: 3, placed: false },
                    { name: 'Submarine', size: 3, placed: false },
                    { name: 'Destroyer', size: 2, placed: false }
                ],
                currentShipIndex: 0,
                orientation: 'horizontal'
            };

            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('battleshipGame').style.display = 'block';
            showBattleshipSetup();
        }

        function exitBattleship() {
            document.getElementById('battleshipGame').style.display = 'none';
            document.getElementById('gamesMenu').style.display = 'block';
        }

        function showBattleshipSetup() {
            const content = document.getElementById('battleshipContent');
            content.innerHTML = `
                <div style="text-align: center; padding: 3rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 1rem;">⚓ Welcome to Battleship!</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem;">Classic naval combat game</p>
                    <div style="background: rgba(255,255,255,0.2); padding: 2rem; border-radius: 10px; margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">How to Play:</h3>
                        <p style="text-align: left; max-width: 500px; margin: 0 auto; line-height: 1.6;">
                            1. Place 5 ships on a 10x10 grid<br>
                            2. Take turns attacking enemy positions<br>
                            3. First to sink all opponent's ships wins!
                        </p>
                    </div>
                    <h3 style="margin-bottom: 1rem;">Choose Game Mode:</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; max-width: 600px; margin: 0 auto;">
                        <button onclick="selectPassAndPlay()" style="background: white; color: #667eea; border: none; padding: 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">
                            👥 Pass & Play<br>
                            <span style="font-size: 0.9rem; font-weight: normal;">2 Players</span>
                        </button>
                        <button onclick="selectVsAI()" style="background: rgba(255,255,255,0.3); color: white; border: 2px solid white; padding: 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">
                            🤖 vs Computer<br>
                            <span style="font-size: 0.9rem; font-weight: normal;">Single Player</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function selectPassAndPlay() {
            battleshipState.isAI = false;
            showPlayerNames();
        }

        function selectVsAI() {
            battleshipState.isAI = true;
            showPlayerNames();
        }

        function showPlayerNames() {
            const content = document.getElementById('battleshipContent');
            content.innerHTML = `
                <div style="text-align: center; padding: 3rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 2rem;">⚓ Player Names</h2>
                    <div style="background: rgba(255,255,255,0.2); padding: 2rem; border-radius: 10px; max-width: 400px; margin: 0 auto;">
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 1.1rem;">Player 1 Name:</label>
                            <input type="text" id="player1Name" placeholder="Enter name" value="${battleshipState.player1Name || ''}"
                                   style="width: 100%; padding: 0.75rem; border: none; border-radius: 8px; font-size: 1rem;">
                        </div>
                        ${!battleshipState.isAI ? `
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 1.1rem;">Player 2 Name:</label>
                            <input type="text" id="player2Name" placeholder="Enter name" value="${battleshipState.player2Name || ''}"
                                   style="width: 100%; padding: 0.75rem; border: none; border-radius: 8px; font-size: 1rem;">
                        </div>
                        ` : ''}
                        <button onclick="startWithNames()" style="background: white; color: #667eea; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold; width: 100%;">
                            Start Game
                        </button>
                    </div>
                </div>
            `;
        }

        function startWithNames() {
            const player1Input = document.getElementById('player1Name').value.trim();
            const player2Input = battleshipState.isAI ? 'Computer' : document.getElementById('player2Name').value.trim();

            battleshipState.player1Name = player1Input || 'Player 1';
            battleshipState.player2Name = player2Input || 'Player 2';

            startPlayer1Setup();
        }

        function startPassAndPlay() {
            battleshipState.isAI = false;
            startPlayer1Setup();
        }

        function startVsAI() {
            battleshipState.isAI = true;
            startPlayer1Setup();
        }

        function startPlayer1Setup() {
            battleshipState.phase = 'player1_place';
            battleshipState.currentShipIndex = 0;
            showShipPlacement(1);
        }

        function showShipPlacement(player) {
            const ship = battleshipState.ships[battleshipState.currentShipIndex];
            const content = document.getElementById('battleshipContent');
            const playerName = player === 1 ? battleshipState.player1Name : battleshipState.player2Name;

            const canUndo = battleshipState.currentShipIndex > 0;

            content.innerHTML = `
                <div style="background: #f8f9fa; padding: 2rem; border-radius: 15px; margin-bottom: 2rem;">
                    <h3>${playerName} - Place Your Ships</h3>
                    <p>Placing: <strong>${ship.name}</strong> (${ship.size} squares)</p>
                    <p>Ship ${battleshipState.currentShipIndex + 1} of 5</p>
                    <div style="display: flex; gap: 1rem; margin-top: 0.5rem;">
                        <button onclick="toggleOrientation()" style="background: #667eea; color: white; border: none; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer;">
                            Orientation: ${battleshipState.orientation === 'horizontal' ? '→ Horizontal' : '↓ Vertical'}
                        </button>
                        <button onclick="undoLastShip()" style="background: ${canUndo ? '#e74c3c' : '#ccc'}; color: white; border: none; padding: 0.5rem 1rem; border-radius: 8px; cursor: ${canUndo ? 'pointer' : 'not-allowed'};" ${!canUndo ? 'disabled' : ''}>
                            ↶ Undo Last Ship
                        </button>
                    </div>
                </div>
                <div style="display: inline-block; background: white; padding: 1rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    ${renderPlacementGrid(player)}
                </div>
            `;
        }

        function renderPlacementGrid(player) {
            const playerData = player === 1 ? battleshipState.player1 : battleshipState.player2;
            const letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];
            let html = '<div style="display: inline-block;">';

            // Column headers (1-10)
            html += '<div style="display: flex; margin-bottom: 5px; margin-left: 30px;">';
            for (let i = 1; i <= 10; i++) {
                html += `<div style="width: 35px; text-align: center; font-weight: bold; color: #667eea;">${i}</div>`;
            }
            html += '</div>';

            // Grid with row headers (A-J)
            for (let row = 0; row < 10; row++) {
                html += '<div style="display: flex; margin-bottom: 3px;">';
                html += `<div style="width: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #667eea;">${letters[row]}</div>`;
                for (let col = 0; col < 10; col++) {
                    const hasShip = playerData.grid[row][col] !== null;
                    html += `
                        <div onclick="placeShipAt(${row}, ${col})"
                             style="width: 35px; height: 35px; border: 1px solid #ddd; background: ${hasShip ? '#667eea' : '#e9ecef'}; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: white; font-weight: bold; transition: all 0.2s;"
                             onmouseover="this.style.background='${hasShip ? '#764ba2' : '#d4d4d4'}'"
                             onmouseout="this.style.background='${hasShip ? '#667eea' : '#e9ecef'}'">
                            ${hasShip ? '🚢' : ''}
                        </div>
                    `;
                }
                html += '</div>';
            }
            html += '</div>';
            return html;
        }

        function toggleOrientation() {
            battleshipState.orientation = battleshipState.orientation === 'horizontal' ? 'vertical' : 'horizontal';
            showShipPlacement(battleshipState.phase === 'player1_place' ? 1 : 2);
        }

        function undoLastShip() {
            if (battleshipState.currentShipIndex === 0) return;

            const player = battleshipState.phase === 'player1_place' ? 1 : 2;
            const playerData = player === 1 ? battleshipState.player1 : battleshipState.player2;

            // Remove the last ship from the ships array
            const lastShip = playerData.ships.pop();

            // Clear those positions from the grid
            lastShip.positions.forEach(([r, c]) => {
                playerData.grid[r][c] = null;
            });

            // Go back to placing the previous ship
            battleshipState.currentShipIndex--;
            showShipPlacement(player);
        }

        function placeShipAt(row, col) {
            const player = battleshipState.phase === 'player1_place' ? 1 : 2;
            const playerData = player === 1 ? battleshipState.player1 : battleshipState.player2;
            const ship = battleshipState.ships[battleshipState.currentShipIndex];

            // Check if placement is valid
            const positions = [];
            for (let i = 0; i < ship.size; i++) {
                const r = battleshipState.orientation === 'horizontal' ? row : row + i;
                const c = battleshipState.orientation === 'horizontal' ? col + i : col;

                if (r >= 10 || c >= 10 || playerData.grid[r][c] !== null) {
                    alert('Invalid placement! Ship goes off grid or overlaps another ship.');
                    return;
                }

                // Check adjacent squares for other ships (no touching allowed)
                for (let dr = -1; dr <= 1; dr++) {
                    for (let dc = -1; dc <= 1; dc++) {
                        const checkR = r + dr;
                        const checkC = c + dc;
                        if (checkR >= 0 && checkR < 10 && checkC >= 0 && checkC < 10) {
                            if (playerData.grid[checkR][checkC] !== null) {
                                alert('Invalid placement! Ships cannot touch each other (including diagonally).');
                                return;
                            }
                        }
                    }
                }

                positions.push([r, c]);
            }

            // Place the ship
            positions.forEach(([r, c]) => {
                playerData.grid[r][c] = ship.name;
            });

            playerData.ships.push({
                name: ship.name,
                positions: positions,
                hits: []
            });

            battleshipState.currentShipIndex++;

            // Check if all ships placed
            if (battleshipState.currentShipIndex >= battleshipState.ships.length) {
                if (battleshipState.phase === 'player1_place') {
                    showPassPhone(2);
                } else {
                    startBattlePhase();
                }
            } else {
                showShipPlacement(player);
            }
        }

        function showPassPhone(toPlayer) {
            // If AI mode, skip pass phone and auto-place AI ships
            if (battleshipState.isAI && toPlayer === 2) {
                placeAIShips();
                startBattlePhase();
                return;
            }

            const fromPlayerName = toPlayer === 2 ? battleshipState.player1Name : battleshipState.player2Name;
            const toPlayerName = toPlayer === 2 ? battleshipState.player2Name : battleshipState.player1Name;

            const content = document.getElementById('battleshipContent');
            content.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 3rem; margin-bottom: 2rem;">📱 Pass the Phone!</h2>
                    <p style="font-size: 1.5rem; margin-bottom: 3rem;">${fromPlayerName} look away!<br>Give phone to ${toPlayerName}</p>
                    <button onclick="${toPlayer === 2 ? 'startPlayer2Setup()' : 'startBattlePhase()'}" style="background: white; color: #f5576c; border: none; padding: 1.5rem 3rem; border-radius: 10px; cursor: pointer; font-size: 1.3rem; font-weight: bold;">${toPlayerName} Ready!</button>
                </div>
            `;
        }

        function placeAIShips() {
            battleshipState.ships.forEach(shipType => {
                let placed = false;
                while (!placed) {
                    const row = Math.floor(Math.random() * 10);
                    const col = Math.floor(Math.random() * 10);
                    const orientation = Math.random() < 0.5 ? 'horizontal' : 'vertical';

                    // Check if valid placement
                    const positions = [];
                    let valid = true;

                    for (let i = 0; i < shipType.size; i++) {
                        const r = orientation === 'horizontal' ? row : row + i;
                        const c = orientation === 'horizontal' ? col + i : col;

                        if (r >= 10 || c >= 10 || battleshipState.player2.grid[r][c] !== null) {
                            valid = false;
                            break;
                        }

                        // Check adjacent squares for other ships (no touching allowed)
                        for (let dr = -1; dr <= 1; dr++) {
                            for (let dc = -1; dc <= 1; dc++) {
                                const checkR = r + dr;
                                const checkC = c + dc;
                                if (checkR >= 0 && checkR < 10 && checkC >= 0 && checkC < 10) {
                                    if (battleshipState.player2.grid[checkR][checkC] !== null) {
                                        valid = false;
                                        break;
                                    }
                                }
                            }
                            if (!valid) break;
                        }
                        if (!valid) break;

                        positions.push([r, c]);
                    }

                    if (valid) {
                        positions.forEach(([r, c]) => {
                            battleshipState.player2.grid[r][c] = shipType.name;
                        });

                        battleshipState.player2.ships.push({
                            name: shipType.name,
                            positions: positions,
                            hits: []
                        });

                        placed = true;
                    }
                }
            });
        }

        function startPlayer2Setup() {
            battleshipState.phase = 'player2_place';
            battleshipState.currentShipIndex = 0;
            showShipPlacement(2);
        }

        function startBattlePhase() {
            battleshipState.phase = 'battle';
            battleshipState.currentPlayer = 1;
            showBattleTurn();
        }

        function showBattleTurn() {
            const content = document.getElementById('battleshipContent');
            const currentPlayer = battleshipState.currentPlayer;
            const opponent = currentPlayer === 1 ? 2 : 1;
            const opponentData = opponent === 1 ? battleshipState.player1 : battleshipState.player2;

            const playerName = currentPlayer === 1 ? battleshipState.player1Name : battleshipState.player2Name;
            const opponentName = opponent === 1 ? battleshipState.player1Name : battleshipState.player2Name;

            content.innerHTML = `
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem; border-radius: 15px; margin-bottom: 2rem;">
                    <h2 style="margin-bottom: 1rem;">${playerName}'s Turn</h2>
                    <p style="font-size: 1.1rem;">Attack ${opponentName}'s fleet!</p>
                    <div style="display: flex; gap: 2rem; justify-content: center; margin-top: 1rem;">
                        <div>
                            <div style="font-size: 2rem; font-weight: bold;">${opponentData.ships.filter(s => s.hits.length === s.positions.length).length}</div>
                            <div style="font-size: 0.9rem;">Ships Sunk</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; font-weight: bold;">${5 - opponentData.ships.filter(s => s.hits.length === s.positions.length).length}</div>
                            <div style="font-size: 0.9rem;">Ships Remaining</div>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem;">
                    <!-- Attack Grid (opponent's grid - hidden ships) -->
                    <div style="background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 1rem; color: #e74c3c;">🎯 Attack Grid</h3>
                        <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">Click to attack!</p>
                        <div style="display: inline-block;">
                            ${renderAttackGrid(opponent)}
                        </div>
                    </div>

                    <!-- Your Grid (show your ships and where you've been hit) -->
                    <div style="background: white; padding: 1.5rem; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin-bottom: 1rem; color: #667eea;">🚢 Your Fleet</h3>
                        <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">Defend your ships!</p>
                        <div style="display: inline-block;">
                            ${renderDefenseGrid(currentPlayer)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderAttackGrid(opponentPlayer) {
            const opponentData = opponentPlayer === 1 ? battleshipState.player1 : battleshipState.player2;
            const currentPlayerData = battleshipState.currentPlayer === 1 ? battleshipState.player1 : battleshipState.player2;
            const letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];

            let html = '<div style="display: inline-block;">';

            // Column headers (1-10)
            html += '<div style="display: flex; margin-bottom: 5px; margin-left: 30px;">';
            for (let i = 1; i <= 10; i++) {
                html += `<div style="width: 35px; text-align: center; font-weight: bold; color: #e74c3c;">${i}</div>`;
            }
            html += '</div>';

            // Grid with row headers (A-J)
            for (let row = 0; row < 10; row++) {
                html += '<div style="display: flex; margin-bottom: 3px;">';
                html += `<div style="width: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #e74c3c;">${letters[row]}</div>`;
                for (let col = 0; col < 10; col++) {
                    const coord = `${row},${col}`;
                    const hasShip = opponentData.grid[row][col] !== null;
                    const wasHit = currentPlayerData.hits && currentPlayerData.hits.some(h => h[0] === row && h[1] === col);
                    const wasMiss = currentPlayerData.misses && currentPlayerData.misses.some(m => m[0] === row && m[1] === col);

                    let bg = '#e9ecef';
                    let content = '';
                    let clickable = true;

                    if (wasHit) {
                        bg = '#e74c3c';
                        content = '💥';
                        clickable = false;
                    } else if (wasMiss) {
                        bg = '#3498db';
                        content = '💧';
                        clickable = false;
                    }

                    html += `
                        <div onclick="${clickable ? `makeAttack(${row}, ${col})` : ''}"
                             style="width: 35px; height: 35px; border: 1px solid #ddd; background: ${bg}; cursor: ${clickable ? 'pointer' : 'not-allowed'}; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; transition: all 0.2s;"
                             ${clickable ? `onmouseover="this.style.background='#d4d4d4'" onmouseout="this.style.background='${bg}'"` : ''}>
                            ${content}
                        </div>
                    `;
                }
                html += '</div>';
            }
            html += '</div>';
            return html;
        }

        function renderDefenseGrid(player) {
            const playerData = player === 1 ? battleshipState.player1 : battleshipState.player2;
            const opponentData = player === 1 ? battleshipState.player2 : battleshipState.player1;
            const letters = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'];

            let html = '<div style="display: inline-block;">';

            // Column headers (1-10)
            html += '<div style="display: flex; margin-bottom: 5px; margin-left: 30px;">';
            for (let i = 1; i <= 10; i++) {
                html += `<div style="width: 35px; text-align: center; font-weight: bold; color: #667eea;">${i}</div>`;
            }
            html += '</div>';

            // Grid with row headers (A-J)
            for (let row = 0; row < 10; row++) {
                html += '<div style="display: flex; margin-bottom: 3px;">';
                html += `<div style="width: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #667eea;">${letters[row]}</div>`;
                for (let col = 0; col < 10; col++) {
                    const hasShip = playerData.grid[row][col] !== null;
                    const wasHitByOpponent = opponentData.hits && opponentData.hits.some(h => h[0] === row && h[1] === col);
                    const wasMissedByOpponent = opponentData.misses && opponentData.misses.some(m => m[0] === row && m[1] === col);

                    let bg = hasShip ? '#667eea' : '#e9ecef';
                    let content = hasShip ? '🚢' : '';

                    if (wasHitByOpponent) {
                        bg = '#e74c3c';
                        content = '💥';
                    } else if (wasMissedByOpponent) {
                        bg = '#3498db';
                        content = '💧';
                    }

                    html += `
                        <div style="width: 35px; height: 35px; border: 1px solid #ddd; background: ${bg}; display: flex; align-items: center; justify-content: center; font-size: ${hasShip && !wasHitByOpponent ? '0.8rem' : '1.2rem'}; color: white;">
                            ${content}
                        </div>
                    `;
                }
                html += '</div>';
            }
            html += '</div>';
            return html;
        }

        function makeAttack(row, col) {
            const currentPlayer = battleshipState.currentPlayer;
            const opponent = currentPlayer === 1 ? 2 : 1;
            const currentPlayerData = currentPlayer === 1 ? battleshipState.player1 : battleshipState.player2;
            const opponentData = opponent === 1 ? battleshipState.player1 : battleshipState.player2;

            // Check if already attacked
            const alreadyHit = currentPlayerData.hits && currentPlayerData.hits.some(h => h[0] === row && h[1] === col);
            const alreadyMiss = currentPlayerData.misses && currentPlayerData.misses.some(m => m[0] === row && m[1] === col);

            if (alreadyHit || alreadyMiss) {
                alert('You already attacked this spot!');
                return;
            }

            // Check if hit or miss
            const hasShip = opponentData.grid[row][col] !== null;

            if (hasShip) {
                // HIT!
                if (!currentPlayerData.hits) currentPlayerData.hits = [];
                currentPlayerData.hits.push([row, col]);

                // Find which ship was hit and mark it
                const shipName = opponentData.grid[row][col];
                const ship = opponentData.ships.find(s => s.name === shipName);
                if (ship && !ship.hits.some(h => h[0] === row && h[1] === col)) {
                    ship.hits.push([row, col]);
                }

                // Check if ship is sunk
                if (ship && ship.hits.length === ship.positions.length) {
                    setTimeout(() => {
                        alert(`💥 HIT! You sunk their ${ship.name}!`);
                        checkForWin();
                    }, 100);
                } else {
                    setTimeout(() => {
                        alert('💥 HIT!');
                        switchTurn();
                    }, 100);
                    return;
                }
            } else {
                // MISS!
                if (!currentPlayerData.misses) currentPlayerData.misses = [];
                currentPlayerData.misses.push([row, col]);

                setTimeout(() => {
                    alert('💧 Miss!');
                    switchTurn();
                }, 100);
                return;
            }
        }

        function checkForWin() {
            const opponent = battleshipState.currentPlayer === 1 ? 2 : 1;
            const opponentData = opponent === 1 ? battleshipState.player1 : battleshipState.player2;

            const allShipsSunk = opponentData.ships.every(ship => ship.hits.length === ship.positions.length);

            if (allShipsSunk) {
                showWinner();
            } else {
                switchTurn();
            }
        }

        function switchTurn() {
            const nextPlayer = battleshipState.currentPlayer === 1 ? 2 : 1;

            // If AI mode
            if (battleshipState.isAI) {
                if (nextPlayer === 2) {
                    // AI's turn - make AI attack immediately
                    battleshipState.currentPlayer = 2;
                    setTimeout(() => makeAIAttack(), 800);
                } else {
                    // Player 1's turn in AI mode - go straight to battle screen
                    battleshipState.currentPlayer = 1;
                    showBattleTurn();
                }
                return;
            }

            // Pass and play mode - show pass phone screen
            const currentPlayerName = battleshipState.currentPlayer === 1 ? battleshipState.player1Name : battleshipState.player2Name;
            const nextPlayerName = nextPlayer === 1 ? battleshipState.player1Name : battleshipState.player2Name;

            const content = document.getElementById('battleshipContent');
            content.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 3rem; margin-bottom: 2rem;">📱 Pass the Phone!</h2>
                    <p style="font-size: 1.5rem; margin-bottom: 3rem;">${currentPlayerName} look away!<br>Give phone to ${nextPlayerName}</p>
                    <button onclick="continueToNextTurn()" style="background: white; color: #f5576c; border: none; padding: 1.5rem 3rem; border-radius: 10px; cursor: pointer; font-size: 1.3rem; font-weight: bold;">${nextPlayerName} Ready!</button>
                </div>
            `;
        }

        function continueToNextTurn() {
            battleshipState.currentPlayer = battleshipState.currentPlayer === 1 ? 2 : 1;
            showBattleTurn();
        }

        function makeAIAttack() {
            // Initialize AI state if needed
            if (!battleshipState.aiState) {
                battleshipState.aiState = {
                    mode: 'hunt', // 'hunt' or 'target'
                    lastHit: null,
                    targetQueue: []
                };
            }

            let row, col;
            const aiData = battleshipState.player2;
            const playerData = battleshipState.player1;

            // Target mode: AI hit a ship and is trying to sink it
            if (battleshipState.aiState.mode === 'target' && battleshipState.aiState.targetQueue.length > 0) {
                [row, col] = battleshipState.aiState.targetQueue.shift();
            } else {
                // Hunt mode: Random attack
                let found = false;
                while (!found) {
                    row = Math.floor(Math.random() * 10);
                    col = Math.floor(Math.random() * 10);

                    const alreadyHit = aiData.hits && aiData.hits.some(h => h[0] === row && h[1] === col);
                    const alreadyMiss = aiData.misses && aiData.misses.some(m => m[0] === row && m[1] === col);

                    if (!alreadyHit && !alreadyMiss) {
                        found = true;
                    }
                }
                battleshipState.aiState.mode = 'hunt';
            }

            // Execute the attack
            const hasShip = playerData.grid[row][col] !== null;

            if (hasShip) {
                // HIT!
                if (!aiData.hits) aiData.hits = [];
                aiData.hits.push([row, col]);

                const shipName = playerData.grid[row][col];
                const ship = playerData.ships.find(s => s.name === shipName);
                if (ship && !ship.hits.some(h => h[0] === row && h[1] === col)) {
                    ship.hits.push([row, col]);
                }

                // Add adjacent squares to target queue
                if (ship.hits.length < ship.positions.length) {
                    battleshipState.aiState.mode = 'target';
                    battleshipState.aiState.lastHit = [row, col];

                    // Add adjacent squares to queue (up, down, left, right)
                    [[row-1, col], [row+1, col], [row, col-1], [row, col+1]].forEach(([r, c]) => {
                        if (r >= 0 && r < 10 && c >= 0 && c < 10) {
                            const alreadyQueued = battleshipState.aiState.targetQueue.some(t => t[0] === r && t[1] === c);
                            const alreadyHit = aiData.hits && aiData.hits.some(h => h[0] === r && h[1] === c);
                            const alreadyMiss = aiData.misses && aiData.misses.some(m => m[0] === r && m[1] === c);

                            if (!alreadyQueued && !alreadyHit && !alreadyMiss) {
                                battleshipState.aiState.targetQueue.push([r, c]);
                            }
                        }
                    });
                }

                // Check if ship sunk
                if (ship && ship.hits.length === ship.positions.length) {
                    battleshipState.aiState.mode = 'hunt';
                    battleshipState.aiState.targetQueue = [];

                    setTimeout(() => {
                        alert(`💥 Computer HIT! Computer sunk your ${ship.name}!`);
                        checkForWinAI();
                    }, 500);
                } else {
                    setTimeout(() => {
                        alert('💥 Computer HIT!');
                        switchTurn();
                    }, 500);
                }
            } else {
                // MISS!
                if (!aiData.misses) aiData.misses = [];
                aiData.misses.push([row, col]);

                setTimeout(() => {
                    alert('💧 Computer missed!');
                    switchTurn();
                }, 500);
            }
        }

        function checkForWinAI() {
            const allShipsSunk = battleshipState.player1.ships.every(ship => ship.hits.length === ship.positions.length);

            if (allShipsSunk) {
                showWinner();
            } else {
                switchTurn();
            }
        }

        function showWinner() {
            const winner = battleshipState.currentPlayer;
            const content = document.getElementById('battleshipContent');
            const winnerName = winner === 1 ? battleshipState.player1Name : battleshipState.player2Name;

            content.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 4rem; margin-bottom: 1rem;">${winner === 2 && battleshipState.isAI ? '😔' : '🎉'} ${winner === 2 && battleshipState.isAI ? 'Game Over' : 'Victory!'}</h2>
                    <p style="font-size: 2rem; margin-bottom: 3rem;">${winnerName} Wins!</p>
                    <p style="font-size: 1.2rem; margin-bottom: 3rem;">All enemy ships have been sunk!</p>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button onclick="launchBattleship()" style="background: white; color: #667eea; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">🔄 Play Again</button>
                        <button onclick="exitBattleship()" style="background: rgba(255,255,255,0.3); color: white; border: 2px solid white; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">← Back to Games</button>
                    </div>
                </div>
            `;
        }

        // Connect 4 Game
        let connect4State = {
            board: Array(6).fill(null).map(() => Array(7).fill(null)),
            currentPlayer: 1,
            player1Name: '',
            player2Name: '',
            isAI: false,
            gameOver: false
        };

        function launchConnectFour() {
            // Reset game state
            connect4State = {
                board: Array(6).fill(null).map(() => Array(7).fill(null)),
                currentPlayer: 1,
                player1Name: '',
                player2Name: '',
                isAI: false,
                gameOver: false
            };

            document.getElementById('gamesMenu').style.display = 'none';
            document.getElementById('connect4Game').style.display = 'block';
            showConnect4Setup();
        }

        function exitConnect4() {
            document.getElementById('connect4Game').style.display = 'none';
            document.getElementById('gamesMenu').style.display = 'block';
        }

        function showConnect4Setup() {
            const content = document.getElementById('connect4Content');
            content.innerHTML = `
                <div style="text-align: center; padding: 3rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 1rem;">🔴 Welcome to Connect 4!</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem;">Drop your discs and connect four in a row!</p>
                    <div style="background: rgba(255,255,255,0.2); padding: 2rem; border-radius: 10px; margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">How to Play:</h3>
                        <p style="text-align: left; max-width: 500px; margin: 0 auto; line-height: 1.6;">
                            1. Players take turns dropping colored discs<br>
                            2. Discs fall to the lowest available position<br>
                            3. First to get 4 in a row wins (horizontal, vertical, or diagonal)!
                        </p>
                    </div>
                    <h3 style="margin-bottom: 1rem;">Choose Game Mode:</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; max-width: 600px; margin: 0 auto;">
                        <button onclick="selectConnect4PassAndPlay()" style="background: white; color: #f5576c; border: none; padding: 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">
                            👥 Pass & Play<br>
                            <span style="font-size: 0.9rem; font-weight: normal;">2 Players</span>
                        </button>
                        <button onclick="selectConnect4VsAI()" style="background: rgba(255,255,255,0.3); color: white; border: 2px solid white; padding: 1.5rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">
                            🤖 vs Computer<br>
                            <span style="font-size: 0.9rem; font-weight: normal;">Single Player</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function selectConnect4PassAndPlay() {
            connect4State.isAI = false;
            showConnect4PlayerNames();
        }

        function selectConnect4VsAI() {
            connect4State.isAI = true;
            showConnect4PlayerNames();
        }

        function showConnect4PlayerNames() {
            const content = document.getElementById('connect4Content');
            content.innerHTML = `
                <div style="text-align: center; padding: 3rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 2.5rem; margin-bottom: 2rem;">🔴 Player Names</h2>
                    <div style="background: rgba(255,255,255,0.2); padding: 2rem; border-radius: 10px; max-width: 400px; margin: 0 auto;">
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 1.1rem;">Player 1 Name (🔴 Red):</label>
                            <input type="text" id="connect4Player1Name" placeholder="Enter name" value="${connect4State.player1Name || ''}"
                                   style="width: 100%; padding: 0.75rem; border: none; border-radius: 8px; font-size: 1rem;">
                        </div>
                        ${!connect4State.isAI ? `
                        <div style="margin-bottom: 1.5rem;">
                            <label style="display: block; margin-bottom: 0.5rem; font-size: 1.1rem;">Player 2 Name (🟡 Yellow):</label>
                            <input type="text" id="connect4Player2Name" placeholder="Enter name" value="${connect4State.player2Name || ''}"
                                   style="width: 100%; padding: 0.75rem; border: none; border-radius: 8px; font-size: 1rem;">
                        </div>
                        ` : ''}
                        <button onclick="startConnect4WithNames()" style="background: white; color: #f5576c; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold; width: 100%;">
                            Start Game
                        </button>
                    </div>
                </div>
            `;
        }

        function startConnect4WithNames() {
            const player1Input = document.getElementById('connect4Player1Name').value.trim();
            const player2Input = connect4State.isAI ? 'Computer' : document.getElementById('connect4Player2Name').value.trim();

            connect4State.player1Name = player1Input || 'Player 1';
            connect4State.player2Name = player2Input || 'Player 2';

            showConnect4Board();
        }

        function showConnect4Board() {
            const content = document.getElementById('connect4Content');
            const currentPlayerName = connect4State.currentPlayer === 1 ? connect4State.player1Name : connect4State.player2Name;
            const currentColor = connect4State.currentPlayer === 1 ? '🔴' : '🟡';

            content.innerHTML = `
                <div style="text-align: center;">
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 1.5rem; border-radius: 15px; margin-bottom: 2rem;">
                        <h2 style="margin-bottom: 0.5rem;">${currentColor} ${currentPlayerName}'s Turn</h2>
                        <p>Click a column to drop your disc!</p>
                    </div>

                    <div style="display: inline-block; background: #0066cc; padding: 1rem; border-radius: 15px; box-shadow: 0 8px 16px rgba(0,0,0,0.3);">
                        ${renderConnect4Board()}
                    </div>
                </div>
            `;
        }

        function renderConnect4Board() {
            let html = '<div style="display: grid; grid-template-columns: repeat(7, 60px); gap: 8px;">';

            // Render board from top to bottom (row 0 is top)
            for (let row = 0; row < 6; row++) {
                for (let col = 0; col < 7; col++) {
                    const cell = connect4State.board[row][col];
                    let content = '';
                    let bg = 'white';

                    if (cell === 1) {
                        content = '🔴';
                        bg = '#ffcccc';
                    } else if (cell === 2) {
                        content = '🟡';
                        bg = '#ffffcc';
                    }

                    const clickable = !connect4State.gameOver && cell === null && isColumnAvailable(col);

                    html += `
                        <div onclick="${clickable ? `dropDisc(${col})` : ''}"
                             style="width: 60px; height: 60px; background: ${bg}; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; cursor: ${clickable ? 'pointer' : 'default'}; transition: all 0.2s; border: 3px solid #004999;"
                             ${clickable ? `onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'"` : ''}>
                            ${content}
                        </div>
                    `;
                }
            }

            html += '</div>';
            return html;
        }

        function isColumnAvailable(col) {
            return connect4State.board[0][col] === null;
        }

        function dropDisc(col) {
            if (connect4State.gameOver) return;

            // Find the lowest available row in this column
            let row = -1;
            for (let r = 5; r >= 0; r--) {
                if (connect4State.board[r][col] === null) {
                    row = r;
                    break;
                }
            }

            if (row === -1) return; // Column is full

            // Place the disc
            connect4State.board[row][col] = connect4State.currentPlayer;

            // Check for win
            if (checkConnect4Win(row, col)) {
                connect4State.gameOver = true;
                showConnect4Winner();
                return;
            }

            // Check for draw
            if (isBoardFull()) {
                connect4State.gameOver = true;
                showConnect4Draw();
                return;
            }

            // Switch player
            connect4State.currentPlayer = connect4State.currentPlayer === 1 ? 2 : 1;

            // If AI mode and now AI's turn
            if (connect4State.isAI && connect4State.currentPlayer === 2) {
                setTimeout(() => makeAIMove(), 500);
            } else {
                showConnect4Board();
            }
        }

        function checkConnect4Win(row, col) {
            const player = connect4State.board[row][col];

            // Check horizontal
            let count = 1;
            for (let c = col - 1; c >= 0 && connect4State.board[row][c] === player; c--) count++;
            for (let c = col + 1; c < 7 && connect4State.board[row][c] === player; c++) count++;
            if (count >= 4) return true;

            // Check vertical
            count = 1;
            for (let r = row - 1; r >= 0 && connect4State.board[r][col] === player; r--) count++;
            for (let r = row + 1; r < 6 && connect4State.board[r][col] === player; r++) count++;
            if (count >= 4) return true;

            // Check diagonal (top-left to bottom-right)
            count = 1;
            for (let r = row - 1, c = col - 1; r >= 0 && c >= 0 && connect4State.board[r][c] === player; r--, c--) count++;
            for (let r = row + 1, c = col + 1; r < 6 && c < 7 && connect4State.board[r][c] === player; r++, c++) count++;
            if (count >= 4) return true;

            // Check diagonal (top-right to bottom-left)
            count = 1;
            for (let r = row - 1, c = col + 1; r >= 0 && c < 7 && connect4State.board[r][c] === player; r--, c++) count++;
            for (let r = row + 1, c = col - 1; r < 6 && c >= 0 && connect4State.board[r][c] === player; r++, c--) count++;
            if (count >= 4) return true;

            return false;
        }

        function isBoardFull() {
            return connect4State.board[0].every(cell => cell !== null);
        }

        function makeAIMove() {
            // Simple AI: try to win, block opponent, or pick random
            const aiPlayer = 2;
            const humanPlayer = 1;

            // Try to win
            for (let col = 0; col < 7; col++) {
                if (isColumnAvailable(col)) {
                    const row = getLowestRow(col);
                    connect4State.board[row][col] = aiPlayer;
                    if (checkConnect4Win(row, col)) {
                        connect4State.gameOver = true;
                        showConnect4Winner();
                        return;
                    }
                    connect4State.board[row][col] = null; // Undo
                }
            }

            // Try to block
            for (let col = 0; col < 7; col++) {
                if (isColumnAvailable(col)) {
                    const row = getLowestRow(col);
                    connect4State.board[row][col] = humanPlayer;
                    if (checkConnect4Win(row, col)) {
                        connect4State.board[row][col] = aiPlayer;
                        if (isBoardFull()) {
                            connect4State.gameOver = true;
                            showConnect4Draw();
                        } else {
                            connect4State.currentPlayer = 1;
                            showConnect4Board();
                        }
                        return;
                    }
                    connect4State.board[row][col] = null; // Undo
                }
            }

            // Pick random available column
            const availableCols = [];
            for (let col = 0; col < 7; col++) {
                if (isColumnAvailable(col)) availableCols.push(col);
            }

            if (availableCols.length > 0) {
                const col = availableCols[Math.floor(Math.random() * availableCols.length)];
                dropDisc(col);
            }
        }

        function getLowestRow(col) {
            for (let r = 5; r >= 0; r--) {
                if (connect4State.board[r][col] === null) return r;
            }
            return -1;
        }

        function showConnect4Winner() {
            const winner = connect4State.currentPlayer;
            const winnerName = winner === 1 ? connect4State.player1Name : connect4State.player2Name;
            const winnerColor = winner === 1 ? '🔴' : '🟡';

            const content = document.getElementById('connect4Content');
            content.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 4rem; margin-bottom: 1rem;">🎉 Victory!</h2>
                    <p style="font-size: 2rem; margin-bottom: 1rem;">${winnerColor} ${winnerName} Wins!</p>
                    <p style="font-size: 1.2rem; margin-bottom: 3rem;">Four in a row!</p>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button onclick="launchConnectFour()" style="background: white; color: #f5576c; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">🔄 Play Again</button>
                        <button onclick="exitConnect4()" style="background: rgba(255,255,255,0.3); color: white; border: 2px solid white; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">← Back to Games</button>
                    </div>
                </div>
            `;
        }

        function showConnect4Draw() {
            const content = document.getElementById('connect4Content');
            content.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 15px; color: white;">
                    <h2 style="font-size: 4rem; margin-bottom: 1rem;">🤝 Draw!</h2>
                    <p style="font-size: 2rem; margin-bottom: 3rem;">Board is full - it's a tie!</p>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button onclick="launchConnectFour()" style="background: white; color: #f5576c; border: none; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">🔄 Play Again</button>
                        <button onclick="exitConnect4()" style="background: rgba(255,255,255,0.3); color: white; border: 2px solid white; padding: 1rem 2rem; border-radius: 10px; cursor: pointer; font-size: 1.1rem; font-weight: bold;">← Back to Games</button>
                    </div>
                </div>
            `;
        }

        function launchWar() {
            alert('War - Coming Soon!\n\nClassic card game where highest card wins the battle!');
        }

        function launchGuessWho() {
            alert('Guess Who - Coming Soon!\n\nAsk yes/no questions to figure out the mystery person!');
        }

        function launchDotsAndBoxes() {
            alert('Dots and Boxes - Coming Soon!\n\nConnect dots to capture boxes and score points!');
        }

        function launchTicTacToe() {
            alert('Tic Tac Toe - Coming Soon!\n\nClassic X\'s and O\'s - get three in a row to win!');
        }

        function launchTrash() {
            alert('Trash - Coming Soon!\n\nFast-paced card game where you race to get rid of all your cards!');
        }

        function launchISpy() {
            alert('I Spy - Coming Soon!\n\nClassic observation game for spotting things on your road trip!');
        }

        function launchTwentyQuestions() {
            alert('20 Questions - Coming Soon!\n\nGuess what I\'m thinking in 20 questions or less!');
        }

        function launchWouldYouRather() {
            alert('Would You Rather - Coming Soon!\n\nFunny and thought-provoking choices to discuss on your trip!');
        }

        function launchOthello() {
            alert('Othello - Coming Soon!\n\nFlip your opponent\'s discs to your color and dominate the board!');
        }

        function launchTrouble() {
            alert('Trouble - Coming Soon!\n\nPop the dice and race around the board!');
        }

        function launchMinesweeper() {
            alert('Minesweeper - Coming Soon!\n\nUse logic to clear the grid without hitting any mines!');
        }

        // Show toast notification
        function showToast(message, duration = 3000) {
            const toast = document.getElementById('updateToast');
            toast.textContent = message;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed:', err));

                // Listen for update messages from service worker
                navigator.serviceWorker.addEventListener('message', event => {
                    if (event.data.type === 'UPDATE_AVAILABLE') {
                        showToast(`App updated to v${event.data.version}!`);
                    }
                });
            });
        }
    </script>
</body>
</html>
